@model IEnumerable<DHDV.Web.ViewModels.PeopleListItem>
@{ ViewData["Title"]="Gia phả"; var avatar=Url.Content("~/img/avatar.png"); var q = (string?)ViewData["q"] ?? ""; int? gen = (int?)ViewData["gen"]; }
@{ ViewData["Title"]="Gia phả"; }
@await Html.PartialAsync("_Breadcrumb", (("Gia phả","/People")))

<h2 class="mb-3">Gia phả</h2>

<form method="get" class="row g-2 mb-3">
  <div class="col-sm-6 col-md-4">
    <input name="q" value="@q" class="form-control" placeholder="Tìm tên / bí danh">
  </div>
  <div class="col-sm-3 col-md-2">
    <select name="gen" class="form-select">
      <option value="">Đời (tất cả)</option>
      @for (var i=1;i<=20;i++){
        <option value="@i" @(gen==i?"selected":null)>Đời @i</option>
      }
    </select>
  </div>
  <div class="col-auto">
    <button class="btn btn-primary" type="submit">Lọc</button>
  </div>
</form>

<div class="row g-3">
@if (!Model.Any()) { <div class="text-muted">Không có kết quả.</div> }
@foreach (var p in Model)
{
  <div class="col-12 col-md-6 col-lg-4">
    <a asp-controller="People" asp-action="Details" asp-route-id="@p.Id" class="card shadow-sm text-decoration-none text-dark p-3">
      <div class="d-flex align-items-center gap-3">
        <img class="card-img-top"
            src="@img" alt="@p.Name"
            width="400" height="400"
            loading="lazy" decoding="async"
            style="aspect-ratio:1/1"
            onerror="this.onerror=null;this.src='/img/avatar.png';" />
        <div>
          <div class="fw-semibold">@p.Name</div>
          @if(p.Generation!=null){<div class="text-muted small">Đời @p.Generation</div>}
        </div>
      </div>
    </a>
  </div>
}
</div>
