@model IEnumerable<DHDV.Web.Controllers.PostItem>
@{
    ViewData["Title"] = "Posts";
    var q       = (string?)ViewData["q"] ?? "";
    var total   = (int)(ViewData["Total"] ?? 0);
    var page    = (int)(ViewData["Page"] ?? 1);
    var pageSize= (int)(ViewData["PageSize"] ?? 10);
    var pages   = total>0 ? (int)Math.Ceiling((double)total/pageSize) : 1;
}
<nav class="breadcrumb mb-2">
  <a href="/">Home</a> / <span>Posts</span>
</nav>

<h1 class="mb-3">Bài viết</h1>

<form method="get" class="row g-2 align-items-end mb-3">
  <div class="col-md-8">
    <label class="form-label">Tìm kiếm</label>
    <input class="form-control" name="q" value="@q" placeholder="Tiêu đề / nội dung…" />
  </div>
  <div class="col-md-2">
    <label class="form-label">Kích thước trang</label>
    <select class="form-select" name="pageSize">
      @foreach (var s in new[]{10,20,50}) {
        <option value="@s" selected="@(s==pageSize)">@s</option>
      }
    </select>
  </div>
  <div class="col-md-2 d-grid">
    <button class="btn btn-primary">Lọc</button>
  </div>
</form>

@if (!Model.Any())
{
  <div class="alert alert-warning">Không có bài viết.</div>
}
else
{
  <div class="list-group">
    @foreach (var p in Model)
    {
      <a class="list-group-item list-group-item-action" href="/Posts/Details/@p.Id">
        <div class="d-flex justify-content-between">
          <strong>@p.Title</strong>
          @if (p.PublishedAt.HasValue){ <span class="text-muted small">@p.PublishedAt.Value.ToString("yyyy-MM-dd")</span> }
        </div>
      </a>
    }
  </div>

  @if (pages>1){
    <nav class="mt-3" aria-label="Posts pages">
      <ul class="pagination">
        <li class="page-item @(page<=1?"disabled":"")">
          <a class="page-link" href="?q=@q&page=@(page-1)&pageSize=@pageSize">«</a>
        </li>
        @for (var i=1;i<=pages;i++){
          <li class="page-item @(i==page?"active":"")">
            <a class="page-link" href="?q=@q&page=@i&pageSize=@pageSize">@i</a>
          </li>
        }
        <li class="page-item @(page>=pages?"disabled":"")">
          <a class="page-link" href="?q=@q&page=@(page+1)&pageSize=@pageSize">»</a>
        </li>
      </ul>
    </nav>
  }
}
